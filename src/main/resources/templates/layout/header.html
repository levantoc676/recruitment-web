<header th:fragment="header" xmlns:th="http://www.thymeleaf.org">
  <div class="header-container">
    <!-- Logo -->
    <div class="header-left">
      <div class="logo">
        <a class="logo-link" href="/index">
          <img alt="TopCV" class="logo-img" src="/images/logo-topcv.png">
        </a>
      </div>

      <!-- Menu chính -->
      <nav class="nav-menu">
        <ul>
          <li class="menu-item">
            <a href="/jobs">Việc làm</a>
            <div class="mega-menu">
              <div class="mega-column">
                <h4>Việc làm</h4>
                <ul>
                  <li><img alt="" src="/images/search-job.png"> Tìm việc làm</li>
                  <li><img alt="" src="/images/saved-jobs.png"> Việc làm đã lưu</li>
                  <li><img alt="" src="/images/applied-jobs.png"> Việc làm đã ứng tuyển</li>
                  <li><img alt="" src="/images/suitable-jobs.png"> Việc làm phù hợp</li>
                </ul>
              </div>
              <div class="mega-column">
                <h4>Công ty</h4>
                <ul>
                  <li><img alt="" src="/images/company.png"> Danh sách công ty</li>
                  <li><img alt="" src="/images/top-companies.png"> Top công ty</li>
                </ul>
              </div>
              <div class="mega-column">
                <h4>Việc làm theo vị trí</h4>
                <ul>
                  <li>Việc làm Nhân viên kinh doanh</li>
                  <li>Việc làm Kế toán</li>
                  <li>Việc làm Marketing</li>
                  <li>Việc làm Hành chính nhân sự</li>
                  <li>Việc làm Chăm sóc khách hàng</li>
                </ul>
              </div>
            </div>
          </li>

          <li class="menu-item">
            <a href="/cv/create">Tạo CV</a>
            <div class="mega-menu">
              <div class="mega-column">
                <h4>Tạo CV</h4>
                <ul>
                  <li>CV Chuyên nghiệp</li>
                  <li>CV Nhanh</li>
                  <li>CV theo ngành nghề</li>
                </ul>
              </div>
            </div>
          </li>

          <li class="menu-item">
            <a href="/tools">Công cụ</a>
            <div class="mega-menu">
              <div class="mega-column">
                <h4>Công cụ</h4>
                <ul>
                  <li>Ứng dụng TopCV</li>
                  <li>Test IQ / EQ</li>
                  <li>Mẫu hợp đồng</li>
                </ul>
              </div>
            </div>
          </li>

          <li class="menu-item">
            <a href="/blog">Cẩm nang nghề nghiệp</a>
            <div class="mega-menu">
              <div class="mega-column">
                <h4>Cẩm nang</h4>
                <ul>
                  <li>Kinh nghiệm phỏng vấn</li>
                  <li>Hướng dẫn viết CV</li>
                  <li>Mẹo tìm việc</li>
                </ul>
              </div>
            </div>
          </li>

          <li><a href="/pro">TopCV Pro</a></li>
        </ul>
      </nav>
    </div>

    <!-- Bên phải: Auth / User -->
    <div class="header-right">
      <!-- Nếu chưa login -->
      <div th:if="${not #authentication.authenticated}">
        <button onclick="location.href='/auth/register'">Đăng ký</button>
        <button onclick="location.href='/auth/login'">Đăng nhập</button>
      </div>

      <!-- Nếu đã login -->
      <div style="display:flex; align-items:center; gap:8px;"
           th:if="${#authentication.authenticated}">
        Xin chào, <span th:text="${#authentication.name}"></span>!
        <span th:each="auth : ${#authentication.authorities}"
              th:text="${auth.authority} + ' '"></span>
        <button onclick="location.href='/auth/logout'">Đăng xuất</button>

        <!-- ADMIN → Quản lý -->
        <button onclick="location.href='/admin/dashboard'"
                th:if="${#authorization.expression('hasRole(''ADMIN'')')}">
          Quản lý
        </button>

        <!-- EMPLOYER → Đăng tuyển -->
        <button onclick="location.href='/jobs/create'"
                th:if="${#authorization.expression('hasRole(''EMPLOYER'')')}">
          Đăng tuyển
        </button>

        <!-- CANDIDATE → Tạo CV -->
        <button onclick="location.href='/cvs/create'"
                th:if="${#authorization.expression('hasRole(''CANDIDATE'')')}">
          Tạo CV
        </button>
      </div>
    </div>
  </div>
</header>
